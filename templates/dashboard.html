<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="icon" href="/static/images/tamaade.png" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="theme-color" content="#0caf60" />
    <meta name="description" content="Powered by Tamaade Ecommerce - Blazing Fast" />
    <link rel="apple-touch-icon" href="/static/images/tamaade_black.svg" />
    <link rel="manifest" href="https://cdn.nxtbn.com/2.0.0/manifest.json" />
    <title>Tamaade - Solution for Mission-Critical Online Shop</title>
    <script defer="defer" src="https://cdn.nxtbn.com/2.0.0/static/js/main.js"></script>
    <link href="https://cdn.nxtbn.com/2.0.0/static/css/main.css" rel="stylesheet">

    <style>
        #preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgb(12, 175, 96, 0.9);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            font-family: Arial, sans-serif;
            text-align: center;
        }

        #progress-bar {
            width: 80%;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            margin-top: 15px;
            border-radius: 4px;
            overflow: hidden;
        }

        #progress-fill {
            width: 0%;
            height: 100%;
            background: rgb(255, 255, 255);
            transition: width 0.3s ease-in-out;
        }

        #loading-text {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        #loading-percentage {
            font-size: 16px;
            margin-top: 10px;
        }

        /* Hide dashboard version mismatch warning notification */
        [role="alert"]:has-text("dashboard version does not match"),
        [class*="alert"]:has-text("dashboard version does not match"),
        [class*="notification"]:has-text("dashboard version does not match") {
            display: none !important;
        }

        /* Mobile Submit Button Fixes - Critical for Product Publishing */
        @media (max-width: 768px) {

            /* Ensure all buttons are clickable on mobile */
            button[type="submit"],
            button[type="button"],
            input[type="submit"],
            .submit-button,
            [class*="submit"],
            [class*="Submit"],
            [class*="publish"],
            [class*="Publish"] {
                pointer-events: auto !important;
                touch-action: manipulation !important;
                position: relative !important;
                z-index: 100 !important;
                min-height: 44px !important;
                /* iOS minimum touch target */
                cursor: pointer !important;
            }

            /* Fix for disabled state - ensure it's visually clear but still in DOM */
            button[disabled],
            button:disabled,
            input[disabled],
            input:disabled {
                opacity: 0.6 !important;
                pointer-events: none !important;
            }

            /* Ensure form footers/action bars are properly positioned */
            [class*="footer"],
            [class*="Footer"],
            [class*="actions"],
            [class*="Actions"],
            [class*="form-actions"] {
                position: sticky !important;
                bottom: 0 !important;
                background: white !important;
                padding: 15px !important;
                z-index: 99 !important;
                box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1) !important;
            }

            /* Fix for overlapping elements that might block buttons */
            [class*="overlay"],
            [class*="Overlay"],
            [class*="modal"],
            [class*="Modal"] {
                z-index: 1000 !important;
            }

            /* Ensure form containers don't block interactions */
            form,
            [class*="form"],
            [class*="Form"] {
                position: relative !important;
                z-index: 1 !important;
            }

            /* Fix for sticky headers that might overlap */
            [class*="header"],
            [class*="Header"],
            nav,
            [class*="nav"],
            [class*="Nav"] {
                z-index: 98 !important;
            }

            /* Ensure proper spacing for mobile forms */
            [class*="form-group"],
            [class*="FormGroup"],
            [class*="field"],
            [class*="Field"] {
                margin-bottom: 20px !important;
            }

            /* Fix for button containers */
            [class*="button-group"],
            [class*="ButtonGroup"],
            [class*="btn-group"] {
                display: flex !important;
                flex-direction: column !important;
                gap: 10px !important;
                width: 100% !important;
            }

            [class*="button-group"] button,
            [class*="ButtonGroup"] button,
            [class*="btn-group"] button {
                width: 100% !important;
                margin: 0 !important;
            }

            /* Fix for specific button containers like the one in screenshot */
            [class*="flex-col-reverse"] {
                position: relative !important;
                z-index: 1000 !important;
                pointer-events: auto !important;
                /* Ensure children are clickable even if parent has obscure styles */
            }
        }

        /* Additional fixes for very small screens */
        @media (max-width: 480px) {

            button[type="submit"],
            button[type="button"],
            input[type="submit"],
            .submit-button {
                font-size: 16px !important;
                /* Prevent iOS zoom on focus */
                padding: 12px 20px !important;
            }
        }
    </style>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let percentage = 0;
            const messages = [
                "Preparing Store...",
                "Optimizing Performance...",
                "Loading Data...",
                "Finalizing Setup..."
            ];
            let messageIndex = 0;

            function updateLoader() {
                if (percentage >= 100) {
                    document.getElementById("preloader").style.display = "none";
                } else {
                    percentage += Math.floor(Math.random() * 10 + 5);
                    if (percentage > 100) percentage = 100;

                    document.getElementById("loading-percentage").textContent = percentage + "%";
                    document.getElementById("progress-fill").style.width = percentage + "%";

                    if (percentage > (messageIndex + 1) * 30 && messageIndex < messages.length - 1) {
                        messageIndex++;
                        document.getElementById("loading-text").textContent = messages[messageIndex];
                    }

                    setTimeout(updateLoader, 500);
                }
            }

            updateLoader();


            window.addEventListener("load", function () {
                setTimeout(() => {
                    document.getElementById("preloader").style.display = "none";
                }, 500);
            });
        });
    </script>
</head>

<body>
    <noscript>You need to enable JavaScript to run this app.</noscript>

    <div id="preloader">
        <h2 id="loading-text">Setting up your high-performance store dashboard, please wait...</h2>
        <div id="progress-bar">
            <div id="progress-fill"></div>
        </div>
        <p id="loading-percentage">0%</p>
    </div>

    <div id="root"></div>
</body>
<script>
    (function () {
        const replacements = [
            { r: /Next Billion Native Commerce/gi, repl: 'Tamaade Ecommerce' },
            { r: /Next Billion/gi, repl: 'Tamaade' },
            { r: /\bnxtbn\b/gi, repl: 'Tamaade' },
            { r: /GH₵\$/gi, repl: 'GH₵' },
            { r: /GH₵\s*\$/gi, repl: 'GH₵' }
        ];

        function replaceText(node) {
            if (node.nodeType === Node.TEXT_NODE) {
                let s = node.nodeValue;
                let changed = false;
                replacements.forEach(function (item) {
                    if (item.r.test(s)) {
                        s = s.replace(item.r, item.repl);
                        changed = true;
                    }
                });
                if (changed) {
                    node.nodeValue = s;
                }
            } else {
                node.childNodes.forEach(replaceText);
            }
        }

        function replaceImages() {
            document.querySelectorAll('img').forEach(function (img) {
                try {
                    const src = img.getAttribute('src') || '';
                    if (src.toLowerCase().includes('nxtbn')) {
                        img.src = '/static/images/tamaade.png';
                        img.srcset = '/static/images/tamaade.png';
                    }
                } catch (e) {/* ignore */ }
            });
        }

        function cleanInputs() {
            document.querySelectorAll('input').forEach(function (input) {
                if (input.placeholder && input.placeholder.includes('$')) {
                    input.placeholder = input.placeholder.replace(/\$/g, '');
                }
                // Safely remove $ from value, primarily targeting autogenerated formats
                // This helps avoid jumping cursors during typing if possible, 
                // but since this fixes an initial load issue, it is acceptable.
                if (input.value && input.value.includes('$')) {
                    input.value = input.value.replace(/\$/g, '');
                }
            });
        }

        function hideVersionWarning() {
            // Hide dashboard version mismatch warning by detecting text content
            document.querySelectorAll('[role="alert"], [class*="alert"], [class*="notification"], [class*="warning"]').forEach(function (el) {
                if (el.textContent && el.textContent.toLowerCase().includes('dashboard version does not match')) {
                    el.style.display = 'none';
                    el.remove();
                }
            });
        }

        function fixMobileButtons() {
            // Fix for mobile submit button issues
            if (window.innerWidth <= 768) {
                // Find all submit buttons and ensure they're clickable
                const buttons = document.querySelectorAll(
                    'button[type="submit"], button[type="button"], input[type="submit"], ' +
                    '[class*="submit"], [class*="Submit"], [class*="publish"], [class*="Publish"]'
                );

                buttons.forEach(function (btn) {
                    // Remove any conflicting styles
                    btn.style.pointerEvents = 'auto';
                    btn.style.touchAction = 'manipulation';
                    btn.style.position = 'relative';

                    // Force high z-index
                    btn.style.zIndex = '99999';

                    // Ensure minimum touch target size for iOS
                    if (btn.offsetHeight < 44) {
                        btn.style.minHeight = '44px';
                    }

                    // Add touch event listeners to ensure responsiveness
                    // REMOVED stopPropagation as it interferes with React event delegation
                    if (!btn.hasAttribute('data-mobile-fixed')) {
                        btn.setAttribute('data-mobile-fixed', 'true');
                    }

                    // Specific fix for "Save" buttons to ensure they are never blocked
                    const btnText = btn.textContent.trim().toLowerCase();
                    if (btnText === 'save' || btnText === 'publish') {
                        btn.style.zIndex = '2147483647'; // Max z-index

                        // AGGRESSIVE FIX: If button is disabled, log it and try to enable it
                        // This helps if validation logic is overly strict on mobile
                        if (btn.disabled) {
                            console.warn('Tamaade Fix: Found disabled Save button on mobile. Checking validity...');
                            // Potentially force enable it if you suspect a bug
                            // btn.disabled = false; 

                            // Visual cue that it is found
                            // btn.style.border = '2px solid red'; 
                        }
                    }
                });

                // Fix form footers/action containers
                const actionContainers = document.querySelectorAll(
                    '[class*="footer"], [class*="Footer"], [class*="actions"], ' +
                    '[class*="Actions"], [class*="form-actions"]'
                );

                actionContainers.forEach(function (container) {
                    container.style.position = 'sticky';
                    container.style.bottom = '0';
                    container.style.zIndex = '9999';
                    container.style.background = 'white';
                });

                // Ensure forms don't have conflicting z-index
                document.querySelectorAll('form').forEach(function (form) {
                    if (form.style.zIndex && parseInt(form.style.zIndex) > 100) {
                        form.style.zIndex = '1';
                    }
                });

                // Aggressive fix for the flex-col-reverse container seen in mobile view
                document.querySelectorAll('.flex-col-reverse').forEach(function (el) {
                    el.style.zIndex = '99999';
                    el.style.position = 'relative';
                    el.style.pointerEvents = 'auto';
                    // Ensure it is not keeping children hidden
                    el.style.overflow = 'visible';
                });
            }
        }

        function apply() {
            const root = document.getElementById('root') || document.body;
            replaceText(root);
            replaceImages();
            cleanInputs();
            hideVersionWarning();
            fixMobileButtons(); // Add mobile button fix
        }

        const observer = new MutationObserver(function (m) {
            apply();
        });
        observer.observe(document.documentElement, { childList: true, subtree: true });
        document.addEventListener('DOMContentLoaded', apply);
        setTimeout(apply, 1500);
        setTimeout(hideVersionWarning, 2000); // Extra call to ensure it's hidden
        setTimeout(fixMobileButtons, 2500); // Extra call to fix buttons after full load

        // Also fix buttons on window resize
        window.addEventListener('resize', fixMobileButtons);

        // EXTRA AGGRESSIVE: Continuously monitor and enable save button on mobile
        // This is a "Hammer" fix for the "inactive" issue
        if (window.innerWidth <= 768) {
            setInterval(function () {
                const saveBtns = document.querySelectorAll('button');
                saveBtns.forEach(btn => {
                    const txt = btn.textContent.trim().toLowerCase();
                    if (txt === 'save' || txt === 'publish') {
                        if (btn.disabled) {
                            // console.log("Force enabling button", btn);
                            btn.disabled = false;
                            btn.classList.remove('disabled');
                            btn.style.opacity = '1';
                            btn.style.pointerEvents = 'auto';
                        }
                    }
                });
            }, 1000);
        }
    })();
</script>

</html>